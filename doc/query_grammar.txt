== Грамматика языка запросов ==



Выражение ::= Выражение 'ИЛИ' Слагаемое | Слагаемое
Слагаемое ::= Слагаемое 'И' Множитель | Множитель
Множитель ::= НЕ Элемент | Элемент
Элемент ::= Тег | Поле | Директория | Пользователь | '(' Выражение ')'
Тег ::= <слово_без_пробелов>
Поле ::= Тег ОперацияНадПолем Значение
ОперацияНадПолем ::= '=' | '>' | '>=' | '<' | '<=' | '!='
Значение ::= Строка | Число
Строка ::= <Слово_без_пробелов, "Любые символы:#?!, но в кавычках", "Чтобы напечатать кавычку, \" добавить слеш">
Число ::= <целое или вещественное, например: 123, 2.45>
Директория ::= 'dir:' <путь внутри хранилища>
Пользователь ::= 'user:' <логин пользователя хранилища>


Примеры запросов:
1) Поиск среди объектов всех пользователей во всем хранилище
Фото И Море И Оля И Мама
Оля ИЛИ Мама ИЛИ Папа
(Фото ИЛИ Видео) И (Мама ИЛИ Папа)
Фото И Море И Оля И (Мама ИЛИ Папа ИЛИ Бабушка)
Фото И НЕ Море

2) Фотографии пользователей vlkv или lena помеченные данными тегами:
Фото И Море И Оля И Мама user:vlkv user:lena

3) Фотографии внутри одной или другой директории помеченные данными тегами:
Фото И Море И Оля И (Мама ИЛИ Папа ИЛИ Бабушка) dir:foto/2010 dir:foto/new

Связывать операцией И запросы по пользователям или директориям нет смысла, т.к. 
каждый элемент/data_ref может принадлежать только одному пользователю или находиться только
в одной директории


Фото И Море И Оля И Мама И НЕ Ночью



	

	Что делать если путь внутри хранилища содержит пробелы?
	Как можно разрешить, чтобы частью тега могли быть знаки пунктуации (пусть и не все). Escape-последовательности?
	Разделитель дробной части чисел следует локализовать (точка или запятая)?
	Нужно иметь возможность локализовать логические операции языка запросов, например чтобы можно было по желанию заменить 'И' на 'AND'
	Если тег называется ИЛИ, т.е. совпадает с логической операцией, то его надо заключать в кавычки "ИЛИ"
	Если в запросе будет две и больше dir:directory1 И dir:directory2 то смысла в этом особого нет... Точно так же и для пользователей, т.к. каждый элемент принадлежит только одному пользователю.


